process {
  container = 'pytorch/pytorch:1.4-cuda10.1-cudnn7-runtime'

  withLabel: with_cpus {
        cpus = 1
        memory = '7G'
  }
  
  withLabel: with_gpus {
       maxForks = 1
       containerOptions = { workflow.containerEngine == "singularity" ? '--nv':
       ( workflow.containerEngine == "docker" ? '--gpus all': null ) }
  } 
}